<!DOCTYPE html>
<html><head><meta charset="utf-8"></head>
<script type="text/javascript">
<!-- https://dvcs.w3.org/hg/speech-api/raw-file/tip/speechapi.htm -->
	var u = new SpeechSynthesisUtterance();
	//u.text = 'Hello World';
	//u.lang = 'en-US';
	u.text = 'El Instituto Cervantes tiene encomendada la direccion academica';
	u.lang = 'es-ES';
	u.rate = 1.1;
	u.volume=2;
	u.pitch=1;
	//u.voice=voice_instance;
	//u.onend = function(event) { alert('Finished in ' + event.elapsedTime + ' seconds.'); }
	//speechSynthesis.speak(u);
</script>
<body>
<form action="#">
<!-- Llegar donde hay mucho maÃ­z -->
<input type="text" value="Llegar donde hay mucho maiz">
<select>
</select>
<button type="submit">Say It</button>
</form>

<script type="text/javascript">
var synth = window.speechSynthesis;

var inputForm = document.querySelector('form');
var inputTxt = document.querySelector('input');
var voiceSelect = document.querySelector('select');

var populateDone=false;
function populateVoiceList() {
  if (populateDone) return;
  populateDone=true;

  voices = synth.getVoices();
  for(i = 0; i < voices.length ; i++) {
    var option = document.createElement('option');
	var name = voices[i].name.replace('Google','');
    
    if(voices[i].default) {
		option.textContent = '['+name + ' (' + voices[i].lang + ')]';
    }
    else {
		option.textContent = name + ' (' + voices[i].lang + ')';
	}

    option.setAttribute('data-lang', voices[i].lang);
    option.setAttribute('data-name', voices[i].name);
    voiceSelect.appendChild(option);
  }
}

//populateVoiceList();
if (speechSynthesis.onvoiceschanged !== undefined) {
  speechSynthesis.onvoiceschanged = populateVoiceList;
}

inputForm.onsubmit = function(event) {
  event.preventDefault();

  var utterThis = new SpeechSynthesisUtterance(inputTxt.value);
  var selectedOption = voiceSelect.selectedOptions[0].getAttribute('data-name');
  for(i = 0; i < voices.length ; i++) {
    if(voices[i].name === selectedOption) {
      utterThis.voice = voices[i];
    }
  }
  utterThis.rate = 1.1;
  synth.speak(utterThis);
  inputTxt.blur();
}
</script>

</body></html>
